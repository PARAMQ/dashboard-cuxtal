(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{1194:function(t,e,n){"use strict";n(910)},1195:function(t,e,n){var o=n(136),r=n(498),c=n(691),l=o((function(i){return i[1]})),d=r(c);l.push([t.i,".full-w{width:100%!important}.binnalces{height:650px;overflow-y:scroll}#map{min-height:75vh}.card{background-color:#fff!important}.hero.is-cuxtal{background-color:rgba(4,3,3,.604);background-image:url("+d+");background-origin:content-box;background-position:50%;background-repeat:no-repeat;background-size:100%}.modal-background{background-color:rgba(0,0,0,.568)}",""]),l.locals={},t.exports=l},1264:function(t,e,n){"use strict";n.r(e);n(58),n(188);var o=n(5),r=(n(34),n(138),n(502),n(38),n(59),n(711),n(207),n(238),n(60),n(697)),c=n(696),l={name:"Complaint",data:function(){return{openModalFilter:!1,isLoadingData:!1,activeModal:!1,data:[],complaintFilter:[],complaint:{},viewPoints:!1,activatePoints:!1,activeViewModal:!1,dependences:[],temporalPoints:[],zoom:12,center:[-89.60984537598705,20.85610769792424],rotation:0,features:[{type:"Feature",geometry:{type:"Polygon",coordinates:r}}]}},mounted:function(){this.getData(),this.getDependences()},methods:{getData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.isLoadingData=!0,e.next=4,t.$store.dispatch("modules/complaint/getComplaints");case 4:t.data=e.sent,n=t.data.map((function(object){var e=t.dependences.find((function(t){return t.idcoordination===object.iddepto}));return object.dependence=e,object})),t.data=n,t.complaintFilter=n,t.isLoadingData=!1,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:return e.prev=13,t.isLoadingData=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,11,13,16]])})))()},getDataFilter:function(t,e){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,n.isLoadingData=!0,o.next=4,n.$store.dispatch("modules/complaint/getComplaints");case 4:n.data=o.sent,(r=n.data.filter((function(object){if(object.date_reception=new Date(object.date_reception),object.date_reception.getFullYear()===e&&object.date_reception.getMonth()===t){var o=n.dependences.find((function(t){return t.idcoordination===object.iddepto}));return object.dependence=o,object}}))).length>0?(r.sort((function(a,b){return b.date_reception-a.date_reception})),n.data=r,n.complaintFilter=r):(n.data=[],n.complaintFilter=[]),n.openModalFilter=!1,n.isLoadingData=!1,o.next=13;break;case 11:o.prev=11,o.t0=o.catch(0);case 13:return o.prev=13,n.isLoadingData=!1,o.finish(13);case 16:case"end":return o.stop()}}),o,null,[[0,11,13,16]])})))()},filterComplaint:function(text){text&&text.length>0?this.complaintFilter=this.data.filter((function(t){if(t.code.toUpperCase().includes(text.toUpperCase()))return t})):this.complaintFilter=this.data},viewRegister:function(object){this.complaint=object,this.activeViewModal=!0},updateView:function(){this.activeModal=!1,this.activeViewModal=!1,this.complaint={},this.getData()},getComplaint:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$store.dispatch("modules/complaint/getInfoComplaint",t);case 3:return o=n.sent,n.abrupt("return",o);case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),n,null,[[0,7]])})))()},deleteComplaint:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$store.dispatch("modules/complaint/deleteComplaint",t);case 3:e.$buefy.notification.open({message:"denuncia eliminada",duration:2500,position:"is-bottom-right",type:"is-success",hasIcon:!0}),e.getData(),n.next=9;break;case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),n,null,[[0,7]])})))()},viewInMap:function(t){var e=this;if(this.activatePoints=!1,this.viewPoints=!1,t&&t.length>0){var n=[];t.forEach((function(object){var t=[object.x,object.y],o=e.convertCoordinatesToUtm(t);n.push(o)})),this.temporalPoints=n,this.viewPoints=!0,this.activatePoints=!0}else this.$buefy.notification.open({message:"La denuncia no contiene coordenadas.",duration:2500,position:"is-bottom-right",type:"is-warning",hasIcon:!0})},convertCoordinatesToUtm:function(t){var e=c.toLatLon(t[0],t[1],"16","T");return[e.longitude,e.latitude]},getDependences:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("modules/coordinations/getCoordinations");case 3:t.dependences=e.sent,e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))()}}},d=(n(1194),n(76)),component=Object(d.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"columns",attrs:{id:"map"}},[e("b-loading",{attrs:{"is-full-page":!0,"can-cancel":!1},model:{value:t.isLoadingData,callback:function(e){t.isLoadingData=e},expression:"isLoadingData"}}),t._v(" "),e("div",{staticClass:"column is-4"},[e("section",{staticClass:"m-2 has-text-centered"},[e("b-button",{attrs:{label:"Nueva denuncia",type:"is-light"},on:{click:function(e){t.activeModal=!0}}})],1),t._v(" "),e("section",{staticClass:"m-2 has-text-centered"},[e("b-field",{attrs:{label:"Buscar denuncia por folio"}},[e("b-autocomplete",{attrs:{placeholder:"Ejemplo:  ZSCE-RC/DEN-001/2001",data:t.complaintFilter,clearable:t.clearable},on:{typing:t.filterComplaint,select:function(option){return t.viewRegister(option)}},scopedSlots:t._u([{key:"default",fn:function(n){return[e("div",{staticClass:"media"},[e("div",{staticClass:"media-content"},[e("h1",[t._v(t._s(n.option.code))])])])]}}])})],1)],1),t._v(" "),e("section",{staticClass:"m-2 has-text-centered"},[e("b-button",{on:{click:function(e){t.openModalFilter=!0}}},[t._v("Filtrar por mes y año")]),t._v(" "),e("month-picker-filter",{attrs:{"is-open":t.openModalFilter},on:{close:function(e){t.openModalFilter=!1},getData:t.getDataFilter}})],1),t._v(" "),e("div",{staticClass:"columns m-2 binnalces"},[t.data.length>0?e("div",{staticClass:"column"},t._l(t.complaintFilter,(function(n){return e("div",{key:n.idcomplaint},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[e("div",{staticClass:"level m-1 full-w"},[e("div",{staticClass:"level-left"},[e("div",{staticClass:"level-item"},[e("p",[t._v("Código: "+t._s(n.code))])])]),t._v(" "),e("div",{staticClass:"level-right"},[e("div",{staticClass:"level-item"},[e("b-button",{attrs:{type:"is-info is-light","icon-right":"eye-outline"},on:{click:function(e){return t.viewRegister(n)}}})],1),t._v(" "),e("div",{staticClass:"level-item"},[e("b-button",{attrs:{type:"is-danger is-light","icon-right":"delete-empty-outline"},on:{click:function(e){return t.deleteComplaint(n)}}})],1)])])]),t._v(" "),e("div",{staticClass:"card-content",on:{click:function(e){return t.viewInMap(n.complaint_coordinates)}}},[e("p",[e("strong",[t._v("Denuncia presentada ante: ")]),t._v("\n                "+t._s(n.dependence?n.dependence.description:"Sin descripción")+"\n              ")])])])])})),0):e("div",{staticClass:"column has-text-centered"},[e("p",[t._v("Sin registros")])])])]),t._v(" "),e("div",{staticClass:"column is-8"},[e("vl-map",{staticStyle:{height:"100%"},attrs:{"load-tiles-while-animating":!0,"load-tiles-while-interacting":!0,"data-projection":"EPSG:4326"}},[e("vl-view",{attrs:{zoom:t.zoom,center:t.center,rotation:t.rotation},on:{"update:zoom":function(e){t.zoom=e},"update:center":function(e){t.center=e},"update:rotation":function(e){t.rotation=e}}}),t._v(" "),e("vl-layer-tile",[e("vl-source-osm")],1),t._v(" "),t.activatePoints?e("vl-feature",[e("vl-geom-multi-point",{attrs:{coordinates:t.temporalPoints}}),t._v(" "),e("vl-style",[e("vl-style-circle",{attrs:{radius:5}},[e("vl-style-fill",{attrs:{color:"red"}}),t._v(" "),e("vl-style-stroke",{attrs:{color:"red"}})],1)],1)],1):t._e(),t._v(" "),e("vl-layer-vector",[e("vl-source-vector",{attrs:{features:t.features},on:{"update:features":function(e){t.features=e}}})],1)],1)],1),t._v(" "),e("new-incident",{attrs:{"active-modal":t.activeModal},on:{close:t.updateView,save:t.updateView}}),t._v(" "),e("view-incident",{attrs:{"active-modal":t.activeViewModal,"incident-object":t.complaint},on:{close:t.updateView,save:t.updateView}})],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{MonthPickerFilter:n(726).default,NewIncident:n(1212).default,ViewIncident:n(1213).default})},691:function(t,e,n){t.exports=n.p+"img/background.461462f.jpg"},711:function(t,e,n){"use strict";var o=n(33),r=n(39),c=n(169),l=n(139),d=n(170),v=n(505),f=n(72),m=n(40),h=n(504),w=n(395),C=n(712),_=n(713),k=n(267),y=n(714),x=[],D=r(x.sort),F=r(x.push),M=m((function(){x.sort(void 0)})),P=m((function(){x.sort(null)})),R=w("sort"),L=!m((function(){if(k)return k<70;if(!(C&&C>3)){if(_)return!0;if(y)return y<603;var code,t,e,n,o="";for(code=65;code<76;code++){switch(t=String.fromCharCode(code),code){case 66:case 69:case 70:case 72:e=3;break;case 68:case 71:e=4;break;default:e=2}for(n=0;n<47;n++)x.push({k:t+n,v:e})}for(x.sort((function(a,b){return b.v-a.v})),n=0;n<x.length;n++)t=x[n].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));o({target:"Array",proto:!0,forced:M||!P||!R||!L},{sort:function(t){void 0!==t&&c(t);var e=l(this);if(L)return void 0===t?D(e):D(e,t);var n,o,r=[],m=d(e);for(o=0;o<m;o++)o in e&&F(r,e[o]);for(h(r,function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:f(e)>f(n)?1:-1}}(t)),n=d(r),o=0;o<n;)e[o]=r[o++];for(;o<m;)v(e,o++);return e}})},712:function(t,e,n){var o=n(241).match(/firefox\/(\d+)/i);t.exports=!!o&&+o[1]},713:function(t,e,n){var o=n(241);t.exports=/MSIE|Trident/.test(o)},714:function(t,e,n){var o=n(241).match(/AppleWebKit\/(\d+)\./);t.exports=!!o&&+o[1]},726:function(t,e,n){"use strict";n.r(e);n(705);var o={name:"MonthPickerFilter",components:{MonthPicker:n(268).a},props:{isOpen:{type:Boolean,default:!1}},data:function(){return{date:{from:null,to:null,month:null,year:null},meses:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]}},methods:{showDate:function(t){var e=this;this.date=t,this.date.month=this.meses.findIndex((function(t){return t===e.date.month}))}}},r=n(76),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{"can-cancel":!1},model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[e("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[e("header",{staticClass:"modal-card-head"},[e("p",{staticClass:"modal-card-title"},[t._v("\n        Filtrar por año y mes\n      ")]),t._v(" "),e("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}})]),t._v(" "),e("div",{staticClass:"modal-card-body is-flex is-flex-direction-row is-justify-content-center"},[e("month-picker",{attrs:{lang:"es"},on:{change:t.showDate}})],1),t._v(" "),e("footer",{staticClass:"modal-card-foot"},[e("b-button",{attrs:{label:"Filtrar"},on:{click:function(e){return t.$emit("getData",t.date.month,t.date.year)}}})],1)])])}),[],!1,null,null,null);e.default=component.exports},910:function(t,e,n){var content=n(1195);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(137).default)("70b10e14",content,!0,{sourceMap:!1})}}]);