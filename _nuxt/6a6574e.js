(window.webpackJsonp=window.webpackJsonp||[]).push([[145],{1202:function(t,e,n){"use strict";n(914)},1203:function(t,e,n){var o=n(136),r=n(498),c=n(691),l=o((function(i){return i[1]})),d=r(c);l.push([t.i,".full-w{width:100%!important}.binnalces{height:650px;overflow-y:scroll}#map{min-height:75vh}.card{background-color:#fff!important}.hero.is-cuxtal{background-color:rgba(4,3,3,.604);background-image:url("+d+");background-origin:content-box;background-position:50%;background-repeat:no-repeat;background-size:100%}.modal-background{background-color:rgba(0,0,0,.568)}",""]),l.locals={},t.exports=l},1268:function(t,e,n){"use strict";n.r(e);var o=n(5),r=(n(34),n(138),n(711),n(59),n(38),n(207),n(238),n(60),n(697)),c=n(696),l={name:"TechnicalOp",data:function(){return{openModalFilter:!1,isLoadingData:!1,activeModal:!1,data:[],techOpFilter:[],viewOp:!1,temporalPoints:[],activeViewModal:!1,activeEditModal:!1,techOpSelect:{},zoom:12,center:[-89.60984537598705,20.85610769792424],rotation:0,features:[{type:"Feature",geometry:{type:"Polygon",coordinates:r}}]}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.isLoadingData=!0,e.next=4,t.$store.dispatch("modules/technicalOp/getTechnicalOps");case 4:t.data=e.sent,(n=t.data.map((function(t){return t.application_date=new Date(t.application_date),t}))).sort((function(a,b){return b.application_date-a.application_date})),t.techOpFilter=n,t.isLoadingData=!1,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:return e.prev=13,t.isLoadingData=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,11,13,16]])})))()},getDataFilter:function(t,e){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,n.isLoadingData=!0,o.next=4,n.$store.dispatch("modules/technicalOp/getTechnicalOps");case 4:n.data=o.sent,(r=n.data.filter((function(n){if(n.application_date=new Date(n.application_date),n.application_date.getFullYear()===e&&n.application_date.getMonth()===t)return n}))).length>0?(r.sort((function(a,b){return b.application_date-a.application_date})),n.techOpFilter=r):n.techOpFilter=r,n.openModalFilter=!1,n.isLoadingData=!1,o.next=13;break;case 11:o.prev=11,o.t0=o.catch(0);case 13:return o.prev=13,n.isLoadingData=!1,o.finish(13);case 16:case"end":return o.stop()}}),o,null,[[0,11,13,16]])})))()},getOp:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$store.dispatch("modules/technicalOp/getInfoTechnicalOp",t);case 3:return o=n.sent,n.abrupt("return",o);case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),n,null,[[0,7]])})))()},filterTechOp:function(text){text&&text.length>0?this.techOpFilter=this.data.filter((function(t){if(t.folium.toUpperCase().includes(text.toUpperCase()))return t})):this.techOpFilter=this.data},updateView:function(){this.activeModal=!1,this.activeViewModal=!1,this.activeEditModal=!1,this.zoom=12,this.center=[-89.60984537598705,20.85610769792424],this.rotation=0,this.techOpSelect={},this.getData()},viewTechOp:function(object){this.techOpSelect=object,this.activeViewModal=!0},editTechOp:function(object){this.techOpSelect=object,this.activeEditModal=!0},deleteOp:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$store.dispatch("modules/technicalOp/deleteTechnicalOp",t);case 3:e.$buefy.notification.open({message:"Opinión técnica eliminada",duration:2500,position:"is-bottom-right",type:"is-success",hasIcon:!0}),e.getData(),n.next=9;break;case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),n,null,[[0,7]])})))()},viewInMap:function(t){var e=this;this.viewOp=!1,this.temporalPoints=[[-89.60984537598705,20.85610769792424]];var n=[];t&&t.length>0?(t.forEach((function(object){var t=[object.x,object.y],o=e.convertCoordinatesToUtm(t);n.push(o)})),this.temporalPoints=n,this.viewOp=!0):this.$buefy.notification.open({message:"La opinión técnica no contiene coordenadas.",duration:2500,position:"is-bottom-right",type:"is-warning",hasIcon:!0})},convertCoordinatesToUtm:function(t){var e=c.toLatLon(t[0],t[1],"16","T");return[e.longitude,e.latitude]}}},d=(n(1202),n(76)),component=Object(d.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"columns",attrs:{id:"map"}},[e("b-loading",{attrs:{"is-full-page":!0,"can-cancel":!1},model:{value:t.isLoadingData,callback:function(e){t.isLoadingData=e},expression:"isLoadingData"}}),t._v(" "),e("div",{staticClass:"column is-4"},[e("section",{staticClass:"m-2 has-text-centered"},[e("b-button",{attrs:{label:"Nueva opinión técnica",type:"is-light"},on:{click:function(e){t.activeModal=!0}}})],1),t._v(" "),e("section",{staticClass:"m-2 has-text-centered"},[e("b-field",{attrs:{label:"Buscar opinión técnica por folio"}},[e("b-autocomplete",{attrs:{placeholder:"Ejemplo: 1234",data:t.techOpFilter,clearable:t.clearable},on:{typing:t.filterTechOp,select:function(option){return t.viewTechOp(option)}},scopedSlots:t._u([{key:"default",fn:function(n){return[e("div",{staticClass:"media"},[e("div",{staticClass:"media-content"},[e("h1",[t._v(t._s(n.option.folium))])])])]}}])})],1)],1),t._v(" "),e("section",{staticClass:"m-2 has-text-centered"},[e("b-button",{on:{click:function(e){t.openModalFilter=!0}}},[t._v("Filtrar por mes y año")]),t._v(" "),e("month-picker-filter",{attrs:{"is-open":t.openModalFilter},on:{close:function(e){t.openModalFilter=!1},getData:t.getDataFilter}})],1),t._v(" "),e("div",{staticClass:"columns m-2 binnalces"},[t.data.length>0?e("div",{staticClass:"column"},t._l(t.techOpFilter,(function(n){return e("div",{key:n.idtechnical_opinion},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[e("div",{staticClass:"level m-1 full-w"},[e("div",{staticClass:"level-left"},[e("div",{staticClass:"level-item"},[e("p",[t._v("Folio: "+t._s(n.folium))])])]),t._v(" "),e("div",{staticClass:"level-right"},[e("div",{staticClass:"level-item"},[e("b-button",{attrs:{type:"is-info is-light","icon-right":"eye-outline"},on:{click:function(e){return t.viewTechOp(n)}}})],1),t._v(" "),e("div",{staticClass:"level-item"},[e("b-button",{attrs:{type:"is-danger is-light","icon-right":"delete-empty-outline"},on:{click:function(e){return t.deleteOp(n)}}})],1)])])]),t._v(" "),e("div",{staticClass:"card-content",on:{click:function(e){return t.viewInMap(n.list_coordinates)}}},[e("p",[e("strong",[t._v("Motivo de solicitud: ")]),t._v("\n                "+t._s(n.request_motive?n.request_motive:"Sin motivo de solicitud")+"\n              ")]),t._v(" "),e("br"),t._v(" "),e("p",[e("strong",[t._v("Descripción de motivo: ")]),t._v("\n                "+t._s(n.motive_description?n.motive_description:"Sin descripción")+"\n              ")])])])])})),0):e("div",{staticClass:"column has-text-centered"},[e("p",[t._v("Sin registros")])])])]),t._v(" "),e("div",{staticClass:"column is-8"},[e("vl-map",{staticStyle:{height:"100%"},attrs:{"load-tiles-while-animating":!0,"load-tiles-while-interacting":!0,"data-projection":"EPSG:4326"}},[e("vl-view",{attrs:{zoom:t.zoom,center:t.center,rotation:t.rotation},on:{"update:zoom":function(e){t.zoom=e},"update:center":function(e){t.center=e},"update:rotation":function(e){t.rotation=e}}}),t._v(" "),e("vl-layer-tile",[e("vl-source-osm")],1),t._v(" "),t.viewOp?e("vl-feature",[e("vl-geom-multi-point",{attrs:{coordinates:t.temporalPoints}}),t._v(" "),e("vl-style",[e("vl-style-circle",{attrs:{radius:5}},[e("vl-style-fill",{attrs:{color:"red"}}),t._v(" "),e("vl-style-stroke",{attrs:{color:"red"}})],1)],1)],1):t._e(),t._v(" "),e("vl-layer-vector",[e("vl-source-vector",{attrs:{features:t.features},on:{"update:features":function(e){t.features=e}}})],1)],1)],1),t._v(" "),e("new-opinion",{attrs:{"active-modal":t.activeModal},on:{close:t.updateView,save:t.updateView}}),t._v(" "),e("view-opinion",{attrs:{"active-modal":t.activeViewModal,"object-tech":t.techOpSelect},on:{close:t.updateView}}),t._v(" "),e("edit-opinion",{attrs:{"active-modal":t.activeEditModal,"object-tech":t.techOpSelect},on:{close:t.updateView,update:t.updateView}})],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{MonthPickerFilter:n(726).default,NewOpinion:n(1214).default,ViewOpinion:n(1215).default,EditOpinion:n(1216).default})},691:function(t,e,n){t.exports=n.p+"img/background.461462f.jpg"},711:function(t,e,n){"use strict";var o=n(33),r=n(39),c=n(169),l=n(139),d=n(170),v=n(505),f=n(72),h=n(40),m=n(504),_=n(395),w=n(712),O=n(713),k=n(267),y=n(714),C=[],x=r(C.sort),M=r(C.push),D=h((function(){C.sort(void 0)})),F=h((function(){C.sort(null)})),S=_("sort"),T=!h((function(){if(k)return k<70;if(!(w&&w>3)){if(O)return!0;if(y)return y<603;var code,t,e,n,o="";for(code=65;code<76;code++){switch(t=String.fromCharCode(code),code){case 66:case 69:case 70:case 72:e=3;break;case 68:case 71:e=4;break;default:e=2}for(n=0;n<47;n++)C.push({k:t+n,v:e})}for(C.sort((function(a,b){return b.v-a.v})),n=0;n<C.length;n++)t=C[n].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));o({target:"Array",proto:!0,forced:D||!F||!S||!T},{sort:function(t){void 0!==t&&c(t);var e=l(this);if(T)return void 0===t?x(e):x(e,t);var n,o,r=[],h=d(e);for(o=0;o<h;o++)o in e&&M(r,e[o]);for(m(r,function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:f(e)>f(n)?1:-1}}(t)),n=d(r),o=0;o<n;)e[o]=r[o++];for(;o<h;)v(e,o++);return e}})},712:function(t,e,n){var o=n(241).match(/firefox\/(\d+)/i);t.exports=!!o&&+o[1]},713:function(t,e,n){var o=n(241);t.exports=/MSIE|Trident/.test(o)},714:function(t,e,n){var o=n(241).match(/AppleWebKit\/(\d+)\./);t.exports=!!o&&+o[1]},726:function(t,e,n){"use strict";n.r(e);n(705);var o={name:"MonthPickerFilter",components:{MonthPicker:n(268).a},props:{isOpen:{type:Boolean,default:!1}},data:function(){return{date:{from:null,to:null,month:null,year:null},meses:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]}},methods:{showDate:function(t){var e=this;this.date=t,this.date.month=this.meses.findIndex((function(t){return t===e.date.month}))}}},r=n(76),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{"can-cancel":!1},model:{value:t.isOpen,callback:function(e){t.isOpen=e},expression:"isOpen"}},[e("div",{staticClass:"modal-card",staticStyle:{width:"auto"}},[e("header",{staticClass:"modal-card-head"},[e("p",{staticClass:"modal-card-title"},[t._v("\n        Filtrar por año y mes\n      ")]),t._v(" "),e("button",{staticClass:"delete",attrs:{type:"button"},on:{click:function(e){return t.$emit("close")}}})]),t._v(" "),e("div",{staticClass:"modal-card-body is-flex is-flex-direction-row is-justify-content-center"},[e("month-picker",{attrs:{lang:"es"},on:{change:t.showDate}})],1),t._v(" "),e("footer",{staticClass:"modal-card-foot"},[e("b-button",{attrs:{label:"Filtrar"},on:{click:function(e){return t.$emit("getData",t.date.month,t.date.year)}}})],1)])])}),[],!1,null,null,null);e.default=component.exports},914:function(t,e,n){var content=n(1203);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(137).default)("f108ec1e",content,!0,{sourceMap:!1})}}]);