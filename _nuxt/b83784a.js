(window.webpackJsonp=window.webpackJsonp||[]).push([[142],{1181:function(t,e,n){"use strict";n(893)},1182:function(t,e,n){var o=n(165),c=n(494),r=n(678),l=o((function(i){return i[1]})),d=c(r);l.push([t.i,".full-w{width:100%!important}.binnalces{height:650px;overflow-y:scroll}#map{min-height:75vh}.card{background-color:#fff!important}.hero.is-cuxtal{background-color:rgba(4,3,3,.604);background-image:url("+d+");background-origin:content-box;background-position:50%;background-repeat:no-repeat;background-size:100%}.modal-background{background-color:rgba(0,0,0,.568)}",""]),l.locals={},t.exports=l},1245:function(t,e,n){"use strict";n.r(e);var o=n(5),c=(n(59),n(38),n(207),n(237),n(60),n(35),n(684)),r=n(683),l={name:"TechnicalOp",data:function(){return{isLoadingData:!1,activeModal:!1,data:[],techOpFilter:[],viewOp:!1,temporalPoints:[],activeViewModal:!1,activeEditModal:!1,techOpSelect:{},zoom:12,center:[-89.60984537598705,20.85610769792424],rotation:0,features:[{type:"Feature",geometry:{type:"Polygon",coordinates:c}}]}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.isLoadingData=!0,e.next=4,t.$store.dispatch("modules/technicalOp/getTechnicalOps");case 4:t.data=e.sent,t.techOpFilter=t.data,t.isLoadingData=!1,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:return e.prev=11,t.isLoadingData=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[0,9,11,14]])})))()},getOp:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$store.dispatch("modules/technicalOp/getInfoTechnicalOp",t);case 3:return o=n.sent,n.abrupt("return",o);case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),n,null,[[0,7]])})))()},filterTechOp:function(text){text&&text.length>0?this.techOpFilter=this.data.filter((function(t){if(t.folium.toUpperCase().includes(text.toUpperCase()))return t})):this.techOpFilter=this.data},updateView:function(){this.activeModal=!1,this.activeViewModal=!1,this.activeEditModal=!1,this.zoom=12,this.center=[-89.60984537598705,20.85610769792424],this.rotation=0,this.techOpSelect={},this.getData()},viewTechOp:function(object){this.techOpSelect=object,this.activeViewModal=!0},editTechOp:function(object){this.techOpSelect=object,this.activeEditModal=!0},deleteOp:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$store.dispatch("modules/technicalOp/deleteTechnicalOp",t);case 3:e.$buefy.notification.open({message:"Opinión técnica eliminada",duration:2500,position:"is-bottom-right",type:"is-success",hasIcon:!0}),e.getData(),n.next=9;break;case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),n,null,[[0,7]])})))()},viewInMap:function(t){var e=this;this.viewOp=!1,this.temporalPoints=[[-89.60984537598705,20.85610769792424]];var n=[];t&&t.length>0?(t.forEach((function(object){var t=[object.x,object.y],o=e.convertCoordinatesToUtm(t);n.push(o)})),this.temporalPoints=n,this.viewOp=!0):this.$buefy.notification.open({message:"La opinión técnica no contiene coordenadas.",duration:2500,position:"is-bottom-right",type:"is-warning",hasIcon:!0})},convertCoordinatesToUtm:function(t){var e=r.toLatLon(t[0],t[1],"16","T");return[e.longitude,e.latitude]}}},d=(n(1181),n(89)),component=Object(d.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"columns",attrs:{id:"map"}},[e("b-loading",{attrs:{"is-full-page":!0,"can-cancel":!1},model:{value:t.isLoadingData,callback:function(e){t.isLoadingData=e},expression:"isLoadingData"}}),t._v(" "),e("div",{staticClass:"column is-4"},[e("section",{staticClass:"m-2 has-text-centered"},[e("b-button",{attrs:{label:"Nueva opinión técnica",type:"is-light"},on:{click:function(e){t.activeModal=!0}}})],1),t._v(" "),e("section",{staticClass:"m-2 has-text-centered"},[e("b-field",{attrs:{label:"Buscar opinión técnica por folio"}},[e("b-autocomplete",{attrs:{placeholder:"Ejemplo: 1234",data:t.techOpFilter,clearable:t.clearable},on:{typing:t.filterTechOp,select:function(option){return t.viewTechOp(option)}},scopedSlots:t._u([{key:"default",fn:function(n){return[e("div",{staticClass:"media"},[e("div",{staticClass:"media-content"},[e("h1",[t._v(t._s(n.option.folium))])])])]}}])})],1)],1),t._v(" "),e("div",{staticClass:"columns m-2 binnalces"},[t.data.length>0?e("div",{staticClass:"column"},t._l(t.techOpFilter,(function(n){return e("div",{key:n.idtechnical_opinion},[e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[e("div",{staticClass:"level m-1 full-w"},[e("div",{staticClass:"level-left"},[e("div",{staticClass:"level-item"},[e("p",[t._v("Folio: "+t._s(n.folium))])])]),t._v(" "),e("div",{staticClass:"level-right"},[e("div",{staticClass:"level-item"},[e("b-button",{attrs:{type:"is-info is-light","icon-right":"eye-outline"},on:{click:function(e){return t.viewTechOp(n)}}})],1),t._v(" "),e("div",{staticClass:"level-item"},[e("b-button",{attrs:{type:"is-danger is-light","icon-right":"delete-empty-outline"},on:{click:function(e){return t.deleteOp(n)}}})],1)])])]),t._v(" "),e("div",{staticClass:"card-content",on:{click:function(e){return t.viewInMap(n.list_coordinates)}}},[e("p",[e("strong",[t._v("Motivo de solicitud: ")]),t._v("\n                "+t._s(n.request_motive?n.request_motive:"Sin motivo de solicitud")+"\n              ")]),t._v(" "),e("br"),t._v(" "),e("p",[e("strong",[t._v("Descripción de motivo: ")]),t._v("\n                "+t._s(n.motive_description?n.motive_description:"Sin descripción")+"\n              ")])])])])})),0):e("div",{staticClass:"column has-text-centered"},[e("p",[t._v("Sin registros")])])])]),t._v(" "),e("div",{staticClass:"column is-8"},[e("vl-map",{staticStyle:{height:"100%"},attrs:{"load-tiles-while-animating":!0,"load-tiles-while-interacting":!0,"data-projection":"EPSG:4326"}},[e("vl-view",{attrs:{zoom:t.zoom,center:t.center,rotation:t.rotation},on:{"update:zoom":function(e){t.zoom=e},"update:center":function(e){t.center=e},"update:rotation":function(e){t.rotation=e}}}),t._v(" "),e("vl-layer-tile",[e("vl-source-osm")],1),t._v(" "),t.viewOp?e("vl-feature",[e("vl-geom-multi-point",{attrs:{coordinates:t.temporalPoints}}),t._v(" "),e("vl-style",[e("vl-style-circle",{attrs:{radius:5}},[e("vl-style-fill",{attrs:{color:"red"}}),t._v(" "),e("vl-style-stroke",{attrs:{color:"red"}})],1)],1)],1):t._e(),t._v(" "),e("vl-layer-vector",[e("vl-source-vector",{attrs:{features:t.features},on:{"update:features":function(e){t.features=e}}})],1)],1)],1),t._v(" "),e("new-opinion",{attrs:{"active-modal":t.activeModal},on:{close:t.updateView,save:t.updateView}}),t._v(" "),e("view-opinion",{attrs:{"active-modal":t.activeViewModal,"object-tech":t.techOpSelect},on:{close:t.updateView}}),t._v(" "),e("edit-opinion",{attrs:{"active-modal":t.activeEditModal,"object-tech":t.techOpSelect},on:{close:t.updateView,update:t.updateView}})],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{NewOpinion:n(1193).default,ViewOpinion:n(1194).default,EditOpinion:n(1195).default})},678:function(t,e,n){t.exports=n.p+"img/background.461462f.jpg"},893:function(t,e,n){var content=n(1182);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(166).default)("79fea4f4",content,!0,{sourceMap:!1})}}]);